<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>BLP Estimation — blp_estimation • valiCATE</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="BLP Estimation — blp_estimation"><meta property="og:description" content="Estimates the best linear predictor (BLP) of the actual CATEs using the estimated CATEs."><meta property="og:image" content="https://riccardo-df.github.io/valiCATE/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">valiCATE</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/valiCATE-short-tutorial.html">Short Tutorial</a>
</li>
<li>
  <a href="../articles/denoising.html">Denoising</a>
</li>
<li>
  <a href="../articles/hypotheses-testing.html">Hypotheses Testing</a>
</li>
<li>
  <a href="../articles/more-on-plotting.html">More on Plotting</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/riccardo-df/valiCATE" class="external-link">
    <span class="fa fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>BLP Estimation</h1>
    <small class="dont-index">Source: <a href="https://github.com/riccardo-df/evaluCATE/blob/main/R/BLP.R" class="external-link"><code>R/BLP.R</code></a></small>
    <div class="hidden name"><code>blp_estimation.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Estimates the best linear predictor (BLP) of the actual CATEs using the estimated CATEs.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">blp_estimation</span><span class="op">(</span></span>
<span>  <span class="va">Y</span>,</span>
<span>  <span class="va">D</span>,</span>
<span>  <span class="va">cates</span>,</span>
<span>  <span class="va">pscore</span>,</span>
<span>  <span class="va">mu</span>,</span>
<span>  <span class="va">mu0</span>,</span>
<span>  <span class="va">mu1</span>,</span>
<span>  <span class="va">scores</span>,</span>
<span>  <span class="va">strategies</span>,</span>
<span>  <span class="va">denoising</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-y">Y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>Observed outcomes.</p></dd>


<dt id="arg-d">D<a class="anchor" aria-label="anchor" href="#arg-d"></a></dt>
<dd><p>Treatment indicator.</p></dd>


<dt id="arg-cates">cates<a class="anchor" aria-label="anchor" href="#arg-cates"></a></dt>
<dd><p>CATE predictions. Must be produced by a model estimated using different observations than those in <code>Y</code> and <code>D</code>.</p></dd>


<dt id="arg-pscore">pscore<a class="anchor" aria-label="anchor" href="#arg-pscore"></a></dt>
<dd><p>Propensity scores predictions. Must be produced by a model estimated using different observations than those in <code>Y</code> and <code>D</code> (unless the propensity score is known, in which case we provide the true values).</p></dd>


<dt id="arg-mu">mu<a class="anchor" aria-label="anchor" href="#arg-mu"></a></dt>
<dd><p>Conditional mean predictions. Must be produced by a model estimated using different observations than those in <code>Y</code> and <code>D</code></p></dd>


<dt id="arg-mu-">mu0<a class="anchor" aria-label="anchor" href="#arg-mu-"></a></dt>
<dd><p>Control units' conditional mean predictions. Must be produced by a model estimated using different observations than those in <code>Y</code> and <code>D</code></p></dd>


<dt id="arg-mu-">mu1<a class="anchor" aria-label="anchor" href="#arg-mu-"></a></dt>
<dd><p>Treated units' conditional mean predictions. Must be produced by a model estimated using different observations than those in <code>Y</code> and <code>D</code></p></dd>


<dt id="arg-scores">scores<a class="anchor" aria-label="anchor" href="#arg-scores"></a></dt>
<dd><p>Estimated doubly-robust scores. Must be estimated via K-fold cross-fitting using the same observations as in <code>Y</code> and <code>D</code>.</p></dd>


<dt id="arg-strategies">strategies<a class="anchor" aria-label="anchor" href="#arg-strategies"></a></dt>
<dd><p>Character vector controlling the identification strategies to implement for BLP and GATES. Admitted values are <code>"WR"</code> (weighted residuals), <code>"HT"</code> (Horwitz-Thompson), and <code>"AIPW"</code> (augmented inverse-probability weighting).</p></dd>


<dt id="arg-denoising">denoising<a class="anchor" aria-label="anchor" href="#arg-denoising"></a></dt>
<dd><p>Character vector controlling if and which additional covariates to include in the regressions to reduce the variance of the estimation. Admitted values are <code>"none"</code>, <code>"cddf1"</code>, <code>"cddf2"</code>, <code>"mck1"</code>, <code>"mck2"</code>, and <code>"mck3"</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list of fitted models as <code><a href="https://declaredesign.org/r/estimatr/reference/lm_robust.html" class="external-link">lm_robust</a></code> objects.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>To estimate the BLP of the actual CATEs using the estimated CATEs, the user must provide observations on the outcomes and the treatment status of units in
the validation sample, as well as their estimated cates and nuisance functions. Be careful, as these estimates must be obtained using only observations from the training sample (see the example section below).
Additionally, the user must provide doubly-robust scores estimated in the validation sample using K-fold cross fitting.<br></p>
<p>The BLP is estimated using three different strategies, all involving fitting suitable linear models. For each of these strategis, different model specifications are considered that differ in additional and
optional covariates that can be included in the regressions to reduce the estimation variance. Check the online <a href="https://riccardo-df.github.io/valiCATE/articles/valiCATE-short-tutorial.html">short tutorial</a>
and <a href="https://riccardo-df.github.io/valiCATE/articles/denoising.html">denoising vignette</a> for details.<br></p>
<p>Standard errors are estimated using the Eicker-Huber-White estimator.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="gates_estimation.html">gates_estimation</a></code>, <code><a href="toc_estimation.html">toc_estimation</a></code>, <code><a href="rate_estimation.html">rate_estimation</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Riccardo Di Francesco</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Riccardo Di Francesco.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

